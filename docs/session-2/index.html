<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Session 2: Building Approval Workflows | Power Automate Academy</title>
    <link rel="stylesheet" href="../assets/css/styles.css">
    <link rel="stylesheet" href="assets/cheatsheet.css">
</head>
<body>
    <header class="hero">
        <div class="container">
            <div class="logo">
                <img src="../img/amadeus_blue_logo.png" alt="Amadeus" height="32">
            </div>
            <nav>
                <a href="../">← Back to Home</a>
                <a href="#prerequisites">Prerequisites</a>
                <a href="#overview">Overview</a>
                <a href="#steps">Steps</a>
                <a href="#troubleshooting">Troubleshooting</a>
            </nav>
        </div>
    </header>

    <!-- Table of Contents -->
    <nav class="toc-sidebar" id="tocSidebar">
        <div class="toc-content">
            <h3 class="toc-title">Contents</h3>
            <ul class="toc-list">
                <li><a href="#prerequisites" class="toc-link" data-section="prerequisites">Prerequisites</a></li>
                <li><a href="#overview" class="toc-link" data-section="overview">Workflow Overview</a></li>
                <li>
                    <a href="#steps" class="toc-link" data-section="steps">Step-by-Step Instructions</a>
                    <ul class="toc-sublist">
                        <li><a href="#part-1" class="toc-link toc-sublink" data-section="part-1">Step 1: Create Flow</a></li>
                        <li><a href="#part-2" class="toc-link toc-sublink" data-section="part-2">Step 2: Initialize Variables</a></li>
                    </ul>
                </li>
                <li><a href="#troubleshooting" class="toc-link" data-section="troubleshooting">Troubleshooting</a></li>
                <li><a href=".key-concepts" class="toc-link" data-section="key-concepts">Key Concepts Recap</a></li>
            </ul>
        </div>
    </nav>

    <section class="hero-content session-hero">
        <div class="container">
            <div class="session-badge">Session 02</div>
            <div class="hero-logo">
                <img src="assets/images/coe_white_logo.png" alt="CoE Power Platform" width="120">
            </div>
            <h1>Building Approval Workflows</h1>
            <p class="subtitle">RMC Rebate Approval System - Step by Step Guide</p>
            <div class="session-info">
                <span><img src="assets/icons/Clock.svg" width="16" height="16" style="vertical-align: middle; margin-right: 4px;"> Duration: 60 minutes</span>
                <span><img src="assets/icons/Chart.svg" width="16" height="16" style="vertical-align: middle; margin-right: 4px;"> Level: Intermediate</span>
                <span><img src="assets/icons/Settings.svg" width="16" height="16" style="vertical-align: middle; margin-right: 4px;"> Hands-On Workshop</span>
            </div>
        </div>
    </section>

    <section id="prerequisites" class="section">
        <div class="container">
            <h2>Prerequisites</h2>
            <p class="prerequisites-intro">Before starting this hands-on session, make sure you have the following access and knowledge. This will ensure you can follow along smoothly and get the most out of the workshop.</p>

            <div class="prerequisites-grid">
                <div class="prerequisite-card">
                    <div class="prerequisite-header">
                        <img src="assets/icons/Approved.svg" width="24" height="24" class="prerequisite-icon">
                        <h3>Required Access</h3>
                    </div>
                    <div class="prerequisite-content">
                        <a href="https://make.powerautomate.com" target="_blank" class="checklist-item checklist-link">
                            <input type="checkbox" onclick="event.stopPropagation();">
                            <span>Access to Power Automate</span>
                            <img src="assets/icons/External Link.svg" width="16" height="16" class="link-icon">
                        </a>
                        <a href="https://amadeusworkplace.sharepoint.com/sites/CornerOfExcellence/Lists/COE_Academy_PA_Workshop/AllItems.aspx" target="_blank" class="checklist-item checklist-link">
                            <input type="checkbox" onclick="event.stopPropagation();">
                            <span>SharePoint list: <code>COE_Academy_PA_Workshop</code></span>
                            <img src="assets/icons/External Link.svg" width="16" height="16" class="link-icon">
                        </a>
                    </div>
                </div>

                <div class="prerequisite-card">
                    <div class="prerequisite-header">
                        <img src="assets/icons/Light Bulb.svg" width="24" height="24" class="prerequisite-icon">
                        <h3>Basic Knowledge</h3>
                    </div>
                    <div class="prerequisite-content">
                        <ul class="prerequisite-list">
                            <li>Completed Session 1 or familiar with Power Automate basics</li>
                            <li>Understanding of triggers and actions</li>
                            <li>Basic knowledge of SharePoint lists</li>
                        </ul>
                    </div>
                </div>

                <div class="prerequisite-card">
                    <div class="prerequisite-header">
                        <img src="assets/icons/Settings.svg" width="24" height="24" class="prerequisite-icon">
                        <h3>What You'll Need</h3>
                    </div>
                    <div class="prerequisite-content">
                        <ul class="prerequisite-list">
                            <li>Laptop with internet connection</li>
                            <li>Browser: Microsoft Edge or Chrome (recommended)</li>
                            <li>Notepad or note-taking app for reference</li>
                        </ul>
                    </div>
                </div>

                <div class="prerequisite-card">
                    <div class="prerequisite-header">
                        <img src="assets/icons/Clock.svg" width="24" height="24" class="prerequisite-icon">
                        <h3>Time Commitment</h3>
                    </div>
                    <div class="prerequisite-content">
                        <ul class="prerequisite-list">
                            <li>Workshop duration: 60 minutes</li>
                            <li>Hands-on building: ~40 minutes</li>
                            <li>Q&A and troubleshooting: ~20 minutes</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="overview" class="section overview-section">
        <div class="container">
            <h2>Workflow Overview</h2>
            <p class="section-subtitle">This is what we'll build together</p>
            <div class="workflow-diagram">
                <div class="workflow-step">
                    <div class="step-icon trigger"><img src="assets/icons/Play Circle.svg" width="32" height="32"></div>
                    <div class="step-content">
                        <h3>Trigger</h3>
                        <p>New item in SharePoint</p>
                    </div>
                </div>
                <div class="workflow-arrow">↓</div>
                <div class="workflow-step">
                    <div class="step-icon"><img src="assets/icons/Box 1.svg" width="32" height="32"></div>
                    <div class="step-content">
                        <h3>Initialize Variables</h3>
                        <p>Amount, Partner, Email, ID</p>
                    </div>
                </div>
                <div class="workflow-arrow">↓</div>
                <div class="workflow-step">
                    <div class="step-icon"><img src="assets/icons/Settings.svg" width="32" height="32"></div>
                    <div class="step-content">
                        <h3>Condition</h3>
                        <p>Amount > €5,000?</p>
                    </div>
                </div>
                <div class="workflow-branches">
                    <div class="branch branch-yes">
                        <div class="branch-label">YES</div>
                        <div class="workflow-arrow">↓</div>
                        <div class="workflow-step">
                            <div class="step-icon"><img src="assets/icons/Warning.svg" width="32" height="32"></div>
                            <div class="step-content">
                                <h3>Approval Required</h3>
                                <p>Send approval request</p>
                            </div>
                        </div>
                        <div class="workflow-arrow">↓</div>
                        <div class="workflow-step">
                            <div class="step-icon"><img src="assets/icons/Email.svg" width="32" height="32"></div>
                            <div class="step-content">
                                <h3>Update & Notify</h3>
                                <p>SharePoint + Email</p>
                            </div>
                        </div>
                    </div>
                    <div class="branch branch-no">
                        <div class="branch-label">NO</div>
                        <div class="workflow-arrow">↓</div>
                        <div class="workflow-step">
                            <div class="step-icon"><img src="assets/icons/Approved.svg" width="32" height="32"></div>
                            <div class="step-content">
                                <h3>Auto-Approve</h3>
                                <p>Under threshold</p>
                            </div>
                        </div>
                        <div class="workflow-arrow">↓</div>
                        <div class="workflow-step">
                            <div class="step-icon"><img src="assets/icons/Email.svg" width="32" height="32"></div>
                            <div class="step-content">
                                <h3>Update & Notify</h3>
                                <p>SharePoint + Email</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="steps" class="section steps-section">
        <div class="container">
            <h2>Step-by-Step Instructions</h2>
            <div class="progress-tracker">
                <div class="progress-step" data-step="1">Part 1</div>
                <div class="progress-step" data-step="2">Part 2</div>
                <div class="progress-step" data-step="3">Part 3</div>
                <div class="progress-step" data-step="4">Part 4</div>
                <div class="progress-step" data-step="5">Part 5</div>
                <div class="progress-step" data-step="6">Part 6</div>
                <div class="progress-step" data-step="7">Part 7</div>
                <div class="progress-step" data-step="8">Part 8</div>
            </div>

            <!-- Part 1 -->
            <div class="step-part" id="part-1">
                <div class="part-header">
                    <span class="part-number">01</span>
                    <div class="part-title">
                        <h3>Create New Flow</h3>
                        <span class="part-duration"><img src="assets/icons/Clock.svg" width="14" height="14" style="vertical-align: middle; margin-right: 4px;"> 5 minutes</span>
                    </div>
                </div>

                <div class="substep">
                    <h4>Step 1.1: Navigate to Power Automate</h4>
                    <ol>
                        <li>Go to <a href="https://make.powerautomate.com" target="_blank">make.powerautomate.com</a></li>
                        <li>Click <strong>"Create"</strong> in left sidebar</li>
                        <li>Select <strong>"Automated cloud flow"</strong></li>
                    </ol>
                </div>

                <div class="substep">
                    <h4>Step 1.2: Configure Trigger</h4>
                    <ol>
                        <li><strong>Flow name:</strong> <code>RMC Rebate Approval System - [YOUR_NAME]</code></li>
                        <li><strong>Trigger:</strong> Search for "SharePoint"</li>
                        <li>Select <strong>"When an item is created"</strong></li>
                        <li>Click <strong>"Create"</strong></li>
                    </ol>
                </div>

                <div class="substep">
                    <h4>Step 1.3: Set up Trigger</h4>
                    <ul>
                        <li><strong>Site Address:</strong> [Select your SharePoint site]</li>
                        <li><strong>List Name:</strong> <code>COE_Academy_PA_Workshop</code></li>
                        <li>Click <strong>"New step"</strong></li>
                    </ul>
                </div>

                <div class="checkpoint">
                    <strong><img src="assets/icons/Approved.svg" width="18" height="18" style="vertical-align: middle; margin-right: 4px;"> Checkpoint:</strong> Trigger shows "When an item is created" with correct SharePoint list
                </div>
            </div>

            <!-- Part 2 -->
            <div class="step-part" id="part-2">
                <div class="part-header">
                    <span class="part-number">02</span>
                    <div class="part-title">
                        <h3>Initialize Variables</h3>
                        <span class="part-duration"><img src="assets/icons/Clock.svg" width="14" height="14" style="vertical-align: middle; margin-right: 4px;"> 10 minutes</span>
                    </div>
                </div>

                <div class="info-box">
                    <strong><img src="assets/icons/Light Bulb.svg" width="18" height="18" style="vertical-align: middle; margin-right: 4px;"> Why Variables?</strong>
                    <p>Variables store data we'll use multiple times in the flow. This avoids repeating complex expressions.</p>
                </div>

                <div class="substep">
                    <h4>Step 2.1: Initialize Rebate Amount</h4>
                    <ol>
                        <li>Search for <strong>"Initialize variable"</strong></li>
                        <li>Click on action</li>
                        <li>Configure:
                            <ul>
                                <li><strong>Name:</strong> <code>varRebateAmount</code></li>
                                <li><strong>Type:</strong> Float</li>
                                <li><strong>Value:</strong> Click in field → Select <strong>"Rebate Amount"</strong> from Dynamic Content picker</li>
                            </ul>
                        </li>
                    </ol>
                </div>

                <div class="substep">
                    <h4>Step 2.2: Initialize Partner Name</h4>
                    <ol>
                        <li>Click <strong>"New step"</strong></li>
                        <li>Search for <strong>"Initialize variable"</strong></li>
                        <li>Configure:
                            <ul>
                                <li><strong>Name:</strong> <code>varPartnerName</code></li>
                                <li><strong>Type:</strong> String</li>
                                <li><strong>Value:</strong> Click in field → Select <strong>"Partner Name"</strong> from Dynamic Content picker</li>
                            </ul>
                        </li>
                    </ol>
                </div>

                <div class="substep">
                    <h4>Step 2.3: Initialize Analyst Email</h4>
                    <ol>
                        <li>Click <strong>"New step"</strong></li>
                        <li>Search for <strong>"Initialize variable"</strong></li>
                        <li>Configure:
                            <ul>
                                <li><strong>Name:</strong> <code>varAnalystEmail</code></li>
                                <li><strong>Type:</strong> String</li>
                                <li><strong>Value:</strong> Click in field → Select <strong>"Analyst Email"</strong> from Dynamic Content picker</li>
                            </ul>
                        </li>
                    </ol>
                </div>

                <div class="warning-box">
                    <strong><img src="assets/icons/Warning.svg" width="18" height="18" style="vertical-align: middle; margin-right: 4px;"> IMPORTANT:</strong> Use the Dynamic Content picker (lightning bolt icon), NOT manual typing!
                </div>

                <div class="substep">
                    <h4>Step 2.4: Initialize Request ID</h4>
                    <ol>
                        <li>Click <strong>"New step"</strong></li>
                        <li>Search for <strong>"Initialize variable"</strong></li>
                        <li>Configure:
                            <ul>
                                <li><strong>Name:</strong> <code>varRequestID</code></li>
                                <li><strong>Type:</strong> String</li>
                                <li><strong>Value:</strong> Click in field → Select <strong>"Rebate Request ID"</strong> from Dynamic Content picker</li>
                            </ul>
                        </li>
                    </ol>
                </div>

                <div class="checkpoint">
                    <strong><img src="assets/icons/Approved.svg" width="18" height="18" style="vertical-align: middle; margin-right: 4px;"> Checkpoint:</strong> You should have 4 "Initialize variable" actions in sequence
                </div>
            </div>

            <!-- Continue with remaining parts... -->
            <div class="download-section">
                <h3><img src="assets/icons/Download.svg" width="24" height="24" style="vertical-align: middle; margin-right: 8px;"> Download Complete Guide</h3>
                <p>Want the full step-by-step guide with all 8 parts, troubleshooting, and examples?</p>
                <a href="../../CHEAT_SHEET_Workshop_Session_2.md" class="btn btn-primary" download>Download Full Cheat Sheet (Markdown)</a>
            </div>
        </div>
    </section>

    <section id="troubleshooting" class="section troubleshooting-section">
        <div class="container">
            <h2>Troubleshooting Guide</h2>
            <div class="troubleshooting-grid">
                <div class="trouble-item">
                    <h4><img src="assets/icons/Error.svg" width="18" height="18" style="vertical-align: middle; margin-right: 4px;">Variables show error "Unable to process template"</h4>
                    <p><strong>Solution:</strong> Use Dynamic Content picker instead of typing field names manually</p>
                </div>
                <div class="trouble-item">
                    <h4><img src="assets/icons/Error.svg" width="18" height="18" style="vertical-align: middle; margin-right: 4px;">Link to item doesn't work</h4>
                    <p><strong>Solution:</strong> Use <code>triggerBody()?['Link']</code> NOT <code>triggerBody()?['Link'].Value</code></p>
                </div>
                <div class="trouble-item">
                    <h4><img src="assets/icons/Error.svg" width="18" height="18" style="vertical-align: middle; margin-right: 4px;">SharePoint field names look weird</h4>
                    <p><strong>Solution:</strong> Always use Dynamic Content picker - it handles encoding automatically (e.g., <code>Analyst_x0020_Email</code>)</p>
                </div>
                <div class="trouble-item">
                    <h4><img src="assets/icons/Error.svg" width="18" height="18" style="vertical-align: middle; margin-right: 4px;">Flow doesn't trigger</h4>
                    <p><strong>Solution:</strong> Check that you created item in correct SharePoint list, verify flow is ON, check "Run history" for errors</p>
                </div>
                <div class="trouble-item">
                    <h4><img src="assets/icons/Error.svg" width="18" height="18" style="vertical-align: middle; margin-right: 4px;">Email not received</h4>
                    <p><strong>Solution:</strong> Check "Run history", verify email address is correct, check Junk/Spam folder</p>
                </div>
            </div>
        </div>
    </section>

    <section class="section key-concepts">
        <div class="container">
            <h2>Key Concepts Recap</h2>
            <div class="concepts-grid">
                <div class="concept-card">
                    <h3>Trigger</h3>
                    <p>Starts the flow automatically</p>
                    <code>When item created in SharePoint</code>
                </div>
                <div class="concept-card">
                    <h3>Variables</h3>
                    <p>Store data for reuse</p>
                    <code>varRebateAmount, varPartnerName</code>
                </div>
                <div class="concept-card">
                    <h3>Condition</h3>
                    <p>IF/THEN logic</p>
                    <code>If amount > €5,000</code>
                </div>
                <div class="concept-card">
                    <h3>Dynamic Content</h3>
                    <p>Data from previous actions</p>
                    <code>Rebate Amount, Partner Name</code>
                </div>
                <div class="concept-card">
                    <h3>Expressions</h3>
                    <p>Formulas and functions</p>
                    <code>utcNow()</code>
                </div>
                <div class="concept-card">
                    <h3>Approvals</h3>
                    <p>Human decision point</p>
                    <code>Approve/Reject rebate</code>
                </div>
            </div>
        </div>
    </section>

    <section class="section cta-section">
        <div class="container">
            <h2>Ready to Build?</h2>
            <p>Open Power Automate and follow along with this guide</p>
            <div class="cta-buttons">
                <a href="https://make.powerautomate.com" class="btn btn-large btn-primary" target="_blank">Open Power Automate</a>
                <a href="../" class="btn btn-large btn-outline">Back to Home</a>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <p><strong>Power Automate Academy</strong></p>
                    <p>Center of Excellence - Finance Operations</p>
                    <p>Amadeus IT Group</p>
                </div>
                <div class="footer-right">
                    <p>Questions or feedback?</p>
                    <a href="https://github.com/omarriestra/coe-academy-mpa/issues" target="_blank">Open an issue on GitHub</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 CoE Finance Operations. Licensed under MIT.</p>
            </div>
        </div>
    </footer>

    <script src="../assets/js/main.js"></script>
    <script src="assets/cheatsheet.js"></script>
</body>
</html>